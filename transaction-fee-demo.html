<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction Fee System Implementation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #0d1117;
            color: white;
            padding: 40px;
            max-width: 1000px;
            margin: 0 auto;
            line-height: 1.6;
        }
        .demo-container {
            background: #1a1b1f;
            border-radius: 16px;
            padding: 30px;
            margin: 20px 0;
        }
        .feature-box {
            background: #21262d;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #ff6b35;
        }
        .code-demo {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            overflow-x: auto;
        }
        .highlight {
            color: #ff6b35;
            font-weight: 600;
        }
        .wallet-address {
            background: #161b22;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            word-break: break-all;
            border: 1px solid #ff6b35;
        }
        .success {
            color: #28a745;
        }
        .warning {
            color: #ffc107;
        }
        .error {
            color: #dc3545;
        }
        h1 {
            color: #ff6b35;
            text-align: center;
            margin-bottom: 10px;
        }
        h2 {
            color: #58a6ff;
            border-bottom: 1px solid #30363d;
            padding-bottom: 10px;
        }
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-live {
            background: #28a745;
            animation: pulse 2s infinite;
        }
        .fee-display {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 107, 53, 0.2));
            border: 1px solid rgba(255, 107, 53, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        .fee-amount {
            font-size: 24px;
            font-weight: bold;
            color: #ff6b35;
            margin: 10px 0;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .trade-flow {
            display: grid;
            grid-template-columns: 1fr auto 1fr auto 1fr;
            gap: 15px;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
            background: #161b22;
            border-radius: 8px;
        }
        .flow-step {
            text-align: center;
            padding: 15px;
            background: #21262d;
            border-radius: 6px;
        }
        .flow-arrow {
            color: #ff6b35;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <h1>üí∞ Transaction Fee System - IMPLEMENTED</h1>
    <p style="text-align: center; color: #8892b0; margin-bottom: 40px;">
        0.5% platform fee automatically collected on all trades
    </p>

    <div class="demo-container">
        <h2>üéØ Fee Configuration</h2>
        
        <div class="feature-box">
            <h3><span class="status-indicator status-live"></span>Fee Rate: 0.5%</h3>
            <p>Every trade through the platform charges 0.5% of the trade value as a platform fee</p>
            <div class="code-demo">
const FEE_PERCENTAGE = 0.005; // 0.5%</div>
        </div>

        <div class="feature-box">
            <h3><span class="status-indicator status-live"></span>Fee Recipient Wallet</h3>
            <p>All fees are automatically sent to the specified platform wallet:</p>
            <div class="wallet-address">
                FxWWHg9LPWiH9ixwv5CWq6eepTg1A6EYEpMzXC6s98xD
            </div>
            <div class="code-demo">
const FEE_WALLET_ADDRESS = 'FxWWHg9LPWiH9ixwv5CWq6eepTg1A6EYEpMzXC6s98xD';</div>
        </div>
    </div>

    <div class="demo-container">
        <h2>‚ö° How It Works</h2>
        
        <div class="trade-flow">
            <div class="flow-step">
                <h4>1. User Initiates Trade</h4>
                <p>Swap SOL ‚Üî Token</p>
            </div>
            <div class="flow-arrow">‚Üí</div>
            <div class="flow-step">
                <h4>2. Fee Calculated</h4>
                <p>0.5% of trade value</p>
            </div>
            <div class="flow-arrow">‚Üí</div>
            <div class="flow-step">
                <h4>3. Jupiter Swap</h4>
                <p>Main trade executed</p>
            </div>
            <div class="flow-arrow">‚Üí</div>
            <div class="flow-step">
                <h4>4. Fee Transfer</h4>
                <p>SOL sent to platform</p>
            </div>
        </div>

        <div class="feature-box">
            <h3>Fee Calculation Logic</h3>
            <div class="code-demo">
const calculateFeeAmount = () => {
  const sellAmountNum = parseFloat(sellAmount || 0);
  
  let solValue;
  if (fromToken === 'SOL') {
    solValue = sellAmountNum;
  } else {
    // Convert token amount to SOL equivalent
    const usdValue = sellAmountNum * tokenPrice;
    solValue = usdValue / solPrice;
  }
  
  return solValue * FEE_PERCENTAGE; // 0.5%
};</div>
        </div>

        <div class="feature-box">
            <h3>Separate Fee Transaction</h3>
            <p>Fee is sent as a separate SOL transfer transaction for reliability</p>
            <div class="code-demo">
const sendFeeTransaction = async (feeAmountSol) => {
  const feeTransaction = new Transaction();
  
  const feeInstruction = SystemProgram.transfer({
    fromPubkey: new PublicKey(walletAddress),
    toPubkey: new PublicKey(FEE_WALLET_ADDRESS),
    lamports: Math.floor(feeAmountSol * LAMPORTS_PER_SOL),
  });
  
  feeTransaction.add(feeInstruction);
  return await window.solana.signAndSendTransaction(feeTransaction);
};</div>
        </div>
    </div>

    <div class="demo-container">
        <h2>üí° User Experience Features</h2>
        
        <div class="feature-box">
            <h3>üîç Fee Transparency</h3>
            <p>Users see exactly how much fee they'll pay before trading</p>
            <div class="fee-display">
                <div>Platform Fee (0.5%)</div>
                <div class="fee-amount">0.0075 SOL</div>
                <div style="color: #8892b0; font-size: 12px;">
                    Fee is automatically deducted and supports platform development
                </div>
            </div>
        </div>

        <div class="feature-box">
            <h3>‚ö†Ô∏è Balance Validation</h3>
            <p>System checks that users have enough SOL for both trade and fees</p>
            <ul>
                <li><span class="success">‚úì</span> SOL trades: Validates trade amount + fee + gas</li>
                <li><span class="success">‚úì</span> Token trades: Validates fee + gas in SOL</li>
                <li><span class="warning">‚ö†</span> Shows warning if insufficient balance</li>
            </ul>
        </div>

        <div class="feature-box">
            <h3>üîÑ Real-time Fee Updates</h3>
            <p>Fee amount updates automatically as user types trade amounts</p>
            <ul>
                <li><span class="success">‚úì</span> Live calculation based on trade value</li>
                <li><span class="success">‚úì</span> Updates when swapping token directions</li>
                <li><span class="success">‚úì</span> Reflects current SOL and token prices</li>
            </ul>
        </div>
    </div>

    <div class="demo-container">
        <h2>üìä Fee Examples</h2>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div class="feature-box">
                <h3>Example 1: SOL ‚Üí Token</h3>
                <p><strong>Trade:</strong> 1.5 SOL ‚Üí BONK</p>
                <p><strong>SOL Price:</strong> $210</p>
                <p><strong>Trade Value:</strong> $315</p>
                <p><strong>Fee (0.5%):</strong> <span class="highlight">0.0075 SOL (~$1.58)</span></p>
                <p><strong>Total Deducted:</strong> 1.5075 SOL</p>
            </div>
            
            <div class="feature-box">
                <h3>Example 2: Token ‚Üí SOL</h3>
                <p><strong>Trade:</strong> 1M BONK ‚Üí SOL</p>
                <p><strong>BONK Price:</strong> $0.000023</p>
                <p><strong>Trade Value:</strong> $23</p>
                <p><strong>Fee (0.5%):</strong> <span class="highlight">0.00055 SOL (~$0.12)</span></p>
                <p><strong>Additional SOL Needed:</strong> 0.01055 SOL</p>
            </div>
        </div>
    </div>

    <div class="demo-container">
        <h2>üîß Technical Implementation</h2>
        
        <div class="feature-box">
            <h3>Transaction Flow</h3>
            <ol>
                <li><strong>User confirms trade</strong> - System validates balances including fees</li>
                <li><strong>Jupiter swap executes</strong> - Main trading transaction processed</li>
                <li><strong>Fee transfer sends</strong> - Separate SOL transfer to platform wallet</li>
                <li><strong>Success notification</strong> - User sees both transaction signatures</li>
            </ol>
        </div>

        <div class="feature-box">
            <h3>Error Handling</h3>
            <ul>
                <li><span class="success">‚úì</span> Main trade succeeds, fee fails ‚Üí Trade still completes</li>
                <li><span class="warning">‚ö†</span> Insufficient SOL ‚Üí Shows clear warning before trade</li>
                <li><span class="error">‚úó</span> Main trade fails ‚Üí No fee is charged</li>
            </ul>
        </div>

        <div class="feature-box">
            <h3>Security Features</h3>
            <ul>
                <li><span class="success">‚úì</span> Fee wallet address is hardcoded and immutable</li>
                <li><span class="success">‚úì</span> Fee percentage is fixed at 0.5%</li>
                <li><span class="success">‚úì</span> Users see exact fee amount before confirming</li>
                <li><span class="success">‚úì</span> All transactions go through user's wallet for approval</li>
            </ul>
        </div>
    </div>

    <div class="demo-container">
        <h2>üéÆ Testing the Fee System</h2>
        <p>To test the transaction fee system:</p>
        <ol>
            <li>Open the app at <a href="http://localhost:5173" style="color: #58a6ff;">http://localhost:5173</a></li>
            <li>Click on any meme coin to open the trading modal</li>
            <li>Connect your wallet (make sure you have enough SOL)</li>
            <li>Enter a trade amount and observe the fee calculation</li>
            <li>Execute a trade and confirm both transactions in your wallet</li>
            <li>Check the fee wallet balance to verify the fee was received</li>
        </ol>
        
        <div class="feature-box">
            <h3>Expected Behavior</h3>
            <ul>
                <li><span class="success">‚úì</span> Fee amount updates as you type trade amounts</li>
                <li><span class="success">‚úì</span> Warning appears if insufficient SOL for fees</li>
                <li><span class="success">‚úì</span> Two wallet approvals required: swap + fee transfer</li>
                <li><span class="success">‚úì</span> Success message shows both transaction signatures</li>
            </ul>
        </div>
    </div>

    <div class="demo-container" style="text-align: center; border: 2px solid #ff6b35;">
        <h2 style="color: #ff6b35;">üéâ FEE SYSTEM COMPLETE</h2>
        <p style="font-size: 18px; margin: 20px 0;">
            <span class="highlight">0.5% transaction fee</span> is now automatically collected on all trades!
        </p>
        <div class="wallet-address">
            Revenue Wallet: FxWWHg9LPWiH9ixwv5CWq6eepTg1A6EYEpMzXC6s98xD
        </div>
        <p style="color: #8892b0;">
            The fee system is fully transparent, secure, and user-friendly.
        </p>
    </div>

    <script>
        // Add some interactive demo behavior
        document.addEventListener('DOMContentLoaded', function() {
            const feeDisplays = document.querySelectorAll('.fee-display');
            feeDisplays.forEach(display => {
                display.addEventListener('click', function() {
                    this.style.transform = 'scale(1.02)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 200);
                });
            });
        });
    </script>
</body>
</html>
